version: '3'

services:
  php:
    image: {{ container_image }}
    user: {{ user_group_numeric }}
    environment:
      - INSTANCE_ID
      - PUBLIC_IPV4
      - AVAIL_ZONE
      - AWS_REGION
      - SMTP_HOST
      - SMTP_PORT
      - SMTP_TLS
      - ELASTICACHE_CONFIG_HOST
      - ELASTICACHE_CONFIG_PORT
      - MEMCACHED_HOST
      - MEMCACHED_PORT
      - SMTP_USERNAME
      - SMTP_PASSWORD
      - DB_HOST
      - DB_PORT
      - DB_NAME
      - DB_USERNAME
      - DB_PASSWORD
    volumes:
      - {{ web_root_dir }}/{{ site_name }}/htdocs:{{ container_htdocs }}
    networks:
      {{ container_network }}:
        ipv4_address: {{ container_ip }}

networks:
  {{ container_network }}:
    external: true